(this["webpackJsonpdemo-game"]=this["webpackJsonpdemo-game"]||[]).push([[0],{34:function(e,t,n){},35:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r=n(4),c=n.n(r),o=n(28),a=n.n(o),i=(n(34),n(13)),u=n(43),s=n(21),d=(n(35),n(9)),j=n(10),f=n(7),b=function(e){var t=Object(s.c)((function(){return Object(d.a)({rotation:[-Math.PI/2,0,0],position:[0,-1,0],type:"Static"},e)})),n=Object(j.a)(t,1)[0];return Object(f.jsxs)("mesh",{ref:n,receiveShadow:!0,children:[Object(f.jsx)("planeBufferGeometry",{attach:"geometry",args:[100,100]}),Object(f.jsx)("meshStandardMaterial",{attach:"material",color:"blue"})]})},m=n(8),l=n(26),v=Object(l.a)((function(e){return{keyBinds:{moveForward:"KeyW",moveBackwards:"KeyS",moveLeft:"KeyA",moveRight:"KeyD"},down:{},toggleDown:function(t,n){return e((function(e){return Object(d.a)(Object(d.a)({},e),{},{down:Object(d.a)(Object(d.a)({},e.down),{},Object(m.a)({},t,n))})}))}}})),O=function(){var e=v().toggleDown;return Object(r.useEffect)((function(){var t=function(t){e(t.code,!0)},n=function(t){e(t.code,!1)};return document.addEventListener("keydown",t,!1),document.addEventListener("keyup",n,!1),function(){document.removeEventListener("keydown",t),document.removeEventListener("keyup",n)}}),[e]),null},w=function(){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(O,{})})},h=n(6);function p(e){return e.getWorldPosition(e.position)}var y=function(e){var t=e.target,n=Object(r.useRef)(new h.Vector3),c=Object(r.useRef)(new h.Vector3),o=Object(i.c)().camera;return Object(i.b)((function(e,r){var a=t.current;if(a){var i=function(e){var t=new h.Vector3(-0,10,-15);return t.applyQuaternion(e.quaternion),t.add(p(e)),t.y=5,t}(a),u=function(e){var t=new h.Vector3(0,5,20);return t.applyQuaternion(e.quaternion),t.add(p(e)),t}(a),s=1-Math.pow(.01,r);c.current.lerp(i,s),n.current.lerp(u,s),o.position.copy(c.current),o.lookAt(n.current)}})),null};var g=function(){var e=Object(r.useRef)({moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1}),t=v.subscribe,n=v().keyBinds;return Object(r.useEffect)((function(){var r=t((function(t){e.current.moveForward=t}),(function(e){return e.down[n.moveForward]})),c=t((function(t){e.current.moveBackward=t}),(function(e){return e.down[n.moveBackwards]})),o=t((function(t){e.current.moveRight=t}),(function(e){return e.down[n.moveRight]})),a=t((function(t){e.current.moveLeft=t}),(function(e){return e.down[n.moveLeft]}));return function(){r(),c(),o(),a()}}),[t,n,e]),e},x=function(e){var t=e.target,n=Object(r.useRef)(new h.Vector3(-5e-4,-1e-4,-5)),c=Object(r.useRef)(new h.Vector3(1,.25,50)),o=Object(r.useRef)(new h.Vector3(0,0,0)),a=g();return Object(i.b)((function(e,r){if(t.current){var i=a.current,u=i.moveForward,s=i.moveRight,d=i.moveLeft,j=i.moveBackward,f=o.current,b=new h.Vector3(f.x*n.current.x,f.y*n.current.y,f.z*n.current.z);b.multiplyScalar(r),b.z=Math.sign(b.z)*Math.min(Math.abs(b.z),Math.abs(f.z)),f.add(b);var m=t.current,l=new h.Quaternion,v=new h.Vector3,O=m.quaternion.clone(),w=c.current.clone();u&&(f.z+=w.z*r),j&&(f.z-=w.z*r),d&&(v.set(0,1,0),l.setFromAxisAngle(v,4*Math.PI*r*c.current.y),O.multiply(l)),s&&(v.set(0,1,0),l.setFromAxisAngle(v,4*-Math.PI*r*c.current.y),O.multiply(l)),m.quaternion.copy(O);var p=new h.Vector3,y=new h.Vector3(0,0,1);y.applyQuaternion(m.quaternion),y.normalize();var g=new h.Vector3(1,0,0);g.applyQuaternion(m.quaternion),g.normalize(),g.multiplyScalar(f.x*r),y.multiplyScalar(f.z*r),m.position.add(y),m.position.add(g),p.copy(m.position)}})),null},k=function(){var e=Object(r.useRef)();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("mesh",{ref:e,castShadow:!0,receiveShadow:!0,children:[Object(f.jsx)("boxBufferGeometry",{attach:"geometry",args:[1,1,1]}),Object(f.jsx)("meshStandardMaterial",{color:"red"})]}),Object(f.jsx)(y,{target:e}),Object(f.jsx)(x,{target:e})]})};var z=function(){return Object(f.jsxs)("div",{id:"app",children:[Object(f.jsx)(w,{}),Object(f.jsx)(i.a,{children:Object(f.jsx)(s.b,{gravity:[0,-30,0],children:Object(f.jsxs)(s.a,{color:"green",scale:1.1,children:[Object(f.jsx)(u.a,{sunPosition:[100,20,100]}),Object(f.jsx)("ambientLight",{intensity:.25}),Object(f.jsx)("pointLight",{castShadow:!0,intensity:.7,position:[100,100,100]}),Object(f.jsx)(k,{}),Object(f.jsx)(b,{})]})})})]})};a.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(z,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.943dc2b0.chunk.js.map